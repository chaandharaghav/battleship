(()=>{"use strict";function t(t,e,n){return t.board.board[e][n]>0}let e="row";function n(t){e=t}function r(n){const r=document.querySelector("#playArea"),s=document.createElement("div");s.classList.add("place-ships-board");for(let e=0;e<10;e+=1)for(let r=0;r<10;r+=1){const i=document.createElement("div");i.classList.add("cell"),i.dataset.row=e,i.dataset.col=r,t(n,e,r)&&i.classList.add("ship-present"),s.append(i)}const i=document.createElement("button");i.id="direction-button",i.innerText=e[0].toUpperCase()+e.slice(1),r.append(s,i)}const s=function(t){const e=document.createElement("div");e.id="popup";const n=document.createElement("div");n.id="sentence-div",n.innerText=t,e.append(n),document.querySelector("body").append(e),setTimeout((()=>{e.remove()}),1e3)},i=document.querySelector("#playArea");function a(t,e,n,r){switch(e.board.board[n][r]){case"x":t.innerText="x",t.classList.add("hit");break;case-1:t.innerText="x",t.classList.add("missed");break;default:t.innerText="-",t.classList.add("notShot")}}const o=function(t){const e=document.createElement("div");e.classList.add("board");for(let n=0;n<10;n+=1)for(let r=0;r<10;r+=1){const s=document.createElement("div");s.classList.add("cell"),s.dataset.row=n,s.dataset.col=r,a(s,t,n,r),e.append(s)}i.append(e)};const c=class{constructor(t,e,n){this.length=t,this.hitPos=e??new Array(t).fill(null),this.sunk=n??!1}hit(t){this.hitPos[t-1]="hit"}isSunk(){return this.hitPos.every((t=>"hit"===t))}};const d=class{constructor(){this.ships=[],this.board=new Array(10).fill().map((()=>new Array(10).fill(0))),this.missedShots=[]}addShip(t,e,n){const r=new c(t),s={};s.id=this.ships.length+1,s.ship=r,s.position=e,s.direction=n,this.ships.push(s),this.placeShip(s.id,t,e,n)}placeShip(t,e,n,r){const s=n[0],i=n[1];if("column"===r)for(let n=s;n<s+e;n+=1)this.board[n][i]=t;else for(let n=i;n<i+e;n+=1)this.board[s][n]=t}receiveAttack(t){const e=t[0],n=t[1];return 0===this.board[e][n]?(this.board[e][n]=-1,this.missedShots.push(t)):-1===this.board[e][n]||"x"===this.board[e][n]?"alreadyHit":this.registerAttack(t,e,n)}registerAttack(t,e,n){const r=this.ships.find((t=>t.id===this.board[e][n])),{direction:s,position:i}=r;return"column"===s?r.ship.hit(t[0]-i[0]+1):r.ship.hit(t[1]-i[1]+1),r.ship.isSunk()&&(r.ship.sunk=!0),this.board[e][n]="x",r.ship}allShipsSunk(){return this.ships.every((t=>!0===t.ship.isSunk()))}};const u=class{constructor(t){this.name=t,this.attacks=[],this.board=new d,this.isThierTurn=!1}attackRandom(){const t=function(t){const{board:e}=t.board,n=[];for(let t=0;t<e.length;t+=1)for(let r=0;r<t.length;r+=1)"x"!==e[t][r]&&n.push([t,r]);return n}(this),e=(n=t)[Math.round(Math.random()*n.length)];var n;return this.attacks.push(e),e}},l=[];function h(){return l.find((t=>!0===t.isTheirTurn))}function p(){return l.indexOf(l.find((t=>!0===t.isTheirTurn)))}function m(){0===p()?(l[1].isTheirTurn=!0,l[0].isTheirTurn=!1):(l[0].isTheirTurn=!0,l[1].isTheirTurn=!1)}function f(t,e){!function(t,e){const n=new u(t),r=new u(e);n.isTheirTurn=!0,l.push(n,r)}(t,e),r(h())}function b(t){const e=h();e.board.receiveAttack(t),document.querySelector("#playArea").innerHTML="",o(h()),e.board.allShipsSunk()&&s(`${e.name} wins`)}function y(){document.querySelector("#playArea").innerHTML=""}const T=[4,3,3,2,1];let g=0;const v=function(){document.querySelector("body").addEventListener("click",(t=>{"DIV"===t.target.nodeName&&t.target.parentElement.classList.contains("place-ships-board")&&(h().board.addShip(T[g],[parseInt(t.target.dataset.row,10),parseInt(t.target.dataset.col,10)],e),y(),r(h()),g+=1,g===T.length&&(m(),y(),1===p()&&(s(`${h().name} place your ships`),r(h()),g=0),0===p()&&(s(`${h().name}'s turn`),y(),o(h()),document.querySelector("body").addEventListener("click",(t=>{"DIV"===t.target.nodeName&&t.target.parentElement.classList.contains("board")&&(b([parseInt(t.target.dataset.row,10),parseInt(t.target.dataset.col,10)]),m(),s(`${h().name}'s turn`),y(),o(h()))})))))})),document.querySelector("body").addEventListener("click",(t=>{"direction-button"===t.target.id&&("Row"===t.target.innerText?(t.target.innerText="Column",n("column")):(t.target.innerText="Row",n("row")))}))};const E=function(){document.querySelector("#name-form").addEventListener("submit",(t=>{t.preventDefault(),y(),f(t.target[0].value,t.target[1].value),s(`${t.target[0].value} place your ships`),v()}))};(function(){const t=document.createElement("h2");t.innerText="Enter game details";const e=function(){const t=document.createElement("form");t.id="name-form";const e=document.createElement("input");e.id="p1Name",e.type="text",e.required="true";const n=document.createElement("label");n.for=e.id,n.innerText="Player 1 name: ";const r=document.createElement("div");r.classList.add("form-group"),r.append(n,e);const s=document.createElement("input");s.type="text",s.required="true";const i=document.createElement("label");i.for=s.id,i.innerText="Player 2 name: ";const a=document.createElement("div");a.classList.add("form-group"),a.append(i,s);const o=document.createElement("button");o.id="submitBtn",o.innerText="Start Game";const c=document.createElement("div");return c.id="form-div",t.append(r,a,o),c.append(t),c}(),n=document.createElement("section");n.id="form-section",n.append(t,e),document.querySelector("#playArea").append(n)})(),E()})();